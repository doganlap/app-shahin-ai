@model GrcMvc.Models.ViewModels.CreateTenantViewModel
@{
    ViewData["Title"] = "Create Tenant";
    Layout = "_Layout";
}

<div class="container-fluid py-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb mb-1">
            <li class="breadcrumb-item"><a href="@Url.Action("Dashboard")">Platform Admin</a></li>
            <li class="breadcrumb-item"><a href="@Url.Action("Tenants")">Tenants</a></li>
            <li class="breadcrumb-item active">Create</li>
        </ol>
    </nav>
    <h1 class="h3 mb-4">Create New Tenant</h1>

    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-body">
                    <form asp-action="CreateTenant" method="post">
                        @Html.AntiForgeryToken()

                        <h5 class="mb-3">Organization Details</h5>
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label class="form-label">Organization Name <span class="text-danger">*</span></label>
                                <input asp-for="OrganizationName" class="form-control" required>
                                <span asp-validation-for="OrganizationName" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Tenant Slug <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <span class="input-group-text">/t/</span>
                                    <input asp-for="TenantSlug" class="form-control" required placeholder="my-company">
                                </div>
                                <small class="text-muted">URL-friendly identifier (lowercase, no spaces)</small>
                                <span asp-validation-for="TenantSlug" class="text-danger"></span>
                            </div>
                        </div>

                        <h5 class="mb-3">Admin Account</h5>
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label class="form-label">Admin Email <span class="text-danger">*</span></label>
                                <input asp-for="AdminEmail" type="email" class="form-control" required>
                                <small class="text-muted">Primary admin will receive activation email</small>
                                <span asp-validation-for="AdminEmail" class="text-danger"></span>
                            </div>
                        </div>

                        <h5 class="mb-3">Subscription</h5>
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label class="form-label">Subscription Tier</label>
                                <select asp-for="SubscriptionTier" class="form-select">
                                    <option value="MVP">MVP (Basic)</option>
                                    <option value="Professional">Professional</option>
                                    <option value="Enterprise">Enterprise</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Subscription End Date</label>
                                <input asp-for="SubscriptionEndDate" type="date" class="form-control">
                                <small class="text-muted">Leave empty for unlimited</small>
                            </div>
                        </div>

                        <div class="mb-4">
                            <div class="form-check">
                                <input asp-for="BypassPayment" class="form-check-input" type="checkbox">
                                <label class="form-check-label" asp-for="BypassPayment">
                                    Bypass Payment (Owner-created tenant)
                                </label>
                            </div>
                            <small class="text-muted">Skip payment verification for this tenant</small>
                        </div>

                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-plus-circle"></i> Create Tenant
                            </button>
                            <a href="@Url.Action("Tenants")" class="btn btn-outline-secondary">Cancel</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card bg-light">
                <div class="card-body">
                    <h6><i class="bi bi-info-circle"></i> What happens next?</h6>
                    <ol class="mb-0 ps-3">
                        <li>Tenant record is created with "Pending" status</li>
                        <li>Admin account is generated with temporary credentials</li>
                        <li>Activation email is sent to admin</li>
                        <li>Admin completes onboarding wizard</li>
                        <li>Tenant becomes "Active"</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.querySelector('input[name="OrganizationName"]').addEventListener('input', function(e) {
            var slug = e.target.value.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
            document.querySelector('input[name="TenantSlug"]').value = slug;
        });
    </script>
}
