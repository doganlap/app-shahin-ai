@using Microsoft.AspNetCore.Mvc.Localization
@inject IHtmlLocalizer<SharedResource> L
@model GrcMvc.Services.Interfaces.GrcMaturityScoreDto
@{
    ViewData["Title"] = "Maturity Improvement Roadmap";
    Layout = "_Layout";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col">
            <h2><i class="bi bi-map"></i> GRC Maturity Improvement Roadmap</h2>
            <p class="text-muted">Strategic plan to advance GRC maturity to the next level</p>
        </div>
        <div class="col text-end">
            <a asp-action="CMM" class="btn btn-outline-secondary">
                <i class="bi bi-bar-chart-steps"></i> CMM View
            </a>
            <button type="button" class="btn btn-primary" onclick="window.print()">
                <i class="bi bi-printer"></i> Print Roadmap
            </button>
        </div>
    </div>

    <!-- Current vs Target Maturity -->
    @{
        var currentLevel = (int)Math.Floor((Model.ProcessMaturity + Model.PeopleMaturity + Model.TechnologyMaturity + Model.GovernanceMaturity + Model.CultureMaturity) / 5.0m);
        var targetLevel = Math.Min(currentLevel + 1, 5);
    }

    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card shadow-sm border-warning">
                <div class="card-body text-center">
                    <h6 class="text-muted">Current Maturity Level</h6>
                    <h1 class="display-3 text-warning mb-0">Level @currentLevel</h1>
                    <p class="text-muted">@GetLevelName(currentLevel)</p>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card shadow-sm border-success">
                <div class="card-body text-center">
                    <h6 class="text-muted">Target Maturity Level</h6>
                    <h1 class="display-3 text-success mb-0">Level @targetLevel</h1>
                    <p class="text-muted">@GetLevelName(targetLevel)</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Roadmap Timeline -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="bi bi-calendar-range"></i> 12-Month Improvement Roadmap</h5>
                </div>
                <div class="card-body">
                    <div class="roadmap-timeline">
                        <!-- Q1 -->
                        <div class="timeline-item mb-4">
                            <div class="row">
                                <div class="col-md-2">
                                    <div class="badge bg-primary py-2 px-3" style="font-size: 1rem;">Q1</div>
                                    <p class="small text-muted mt-2">Months 1-3</p>
                                </div>
                                <div class="col-md-10">
                                    <div class="card bg-light">
                                        <div class="card-body">
                                            <h6><i class="bi bi-flag"></i> Foundation Phase</h6>
                                            @if (currentLevel == 1)
                                            {
                                                <ul class="mb-0">
                                                    <li>Conduct comprehensive GRC assessment</li>
                                                    <li>Define GRC roles and responsibilities</li>
                                                    <li>Establish basic risk register and compliance tracking</li>
                                                    <li>Document critical processes and policies</li>
                                                </ul>
                                            }
                                            else if (currentLevel == 2)
                                            {
                                                <ul class="mb-0">
                                                    <li>Standardize GRC processes across departments</li>
                                                    <li>Implement GRC framework (ISO 31000, COSO, COBIT)</li>
                                                    <li>Launch GRC awareness training program</li>
                                                    <li>Deploy GRC platform or toolset</li>
                                                </ul>
                                            }
                                            else if (currentLevel == 3)
                                            {
                                                <ul class="mb-0">
                                                    <li>Define GRC KPIs and metrics</li>
                                                    <li>Implement real-time risk monitoring</li>
                                                    <li>Establish process performance baselines</li>
                                                    <li>Deploy advanced analytics capabilities</li>
                                                </ul>
                                            }
                                            else
                                            {
                                                <ul class="mb-0">
                                                    <li>Implement predictive risk analytics</li>
                                                    <li>Launch continuous improvement initiatives</li>
                                                    <li>Establish innovation labs for GRC</li>
                                                    <li>Begin industry thought leadership activities</li>
                                                </ul>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Q2 -->
                        <div class="timeline-item mb-4">
                            <div class="row">
                                <div class="col-md-2">
                                    <div class="badge bg-info py-2 px-3" style="font-size: 1rem;">Q2</div>
                                    <p class="small text-muted mt-2">Months 4-6</p>
                                </div>
                                <div class="col-md-10">
                                    <div class="card bg-light">
                                        <div class="card-body">
                                            <h6><i class="bi bi-gear"></i> Implementation Phase</h6>
                                            @if (currentLevel == 1)
                                            {
                                                <ul class="mb-0">
                                                    <li>Implement basic GRC workflows</li>
                                                    <li>Conduct initial risk assessments</li>
                                                    <li>Deploy compliance monitoring for key regulations</li>
                                                    <li>Establish incident response procedures</li>
                                                </ul>
                                            }
                                            else if (currentLevel == 2)
                                            {
                                                <ul class="mb-0">
                                                    <li>Integrate GRC processes with business operations</li>
                                                    <li>Implement automated compliance reporting</li>
                                                    <li>Launch cross-functional GRC committees</li>
                                                    <li>Deploy integrated risk-control framework</li>
                                                </ul>
                                            }
                                            else if (currentLevel == 3)
                                            {
                                                <ul class="mb-0">
                                                    <li>Launch executive GRC dashboards</li>
                                                    <li>Implement automated control testing</li>
                                                    <li>Deploy advanced reporting and analytics</li>
                                                    <li>Establish GRC performance benchmarks</li>
                                                </ul>
                                            }
                                            else
                                            {
                                                <ul class="mb-0">
                                                    <li>Deploy AI/ML for risk prediction</li>
                                                    <li>Implement automated remediation workflows</li>
                                                    <li>Launch GRC innovation pilot programs</li>
                                                    <li>Establish external benchmarking partnerships</li>
                                                </ul>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Q3 -->
                        <div class="timeline-item mb-4">
                            <div class="row">
                                <div class="col-md-2">
                                    <div class="badge bg-success py-2 px-3" style="font-size: 1rem;">Q3</div>
                                    <p class="small text-muted mt-2">Months 7-9</p>
                                </div>
                                <div class="col-md-10">
                                    <div class="card bg-light">
                                        <div class="card-body">
                                            <h6><i class="bi bi-graph-up"></i> Optimization Phase</h6>
                                            @if (currentLevel == 1)
                                            {
                                                <ul class="mb-0">
                                                    <li>Refine GRC processes based on lessons learned</li>
                                                    <li>Expand GRC coverage to additional areas</li>
                                                    <li>Conduct first GRC maturity re-assessment</li>
                                                    <li>Prepare for external audit/certification</li>
                                                </ul>
                                            }
                                            else if (currentLevel == 2)
                                            {
                                                <ul class="mb-0">
                                                    <li>Optimize GRC workflows for efficiency</li>
                                                    <li>Conduct first maturity assessment</li>
                                                    <li>Implement continuous improvement process</li>
                                                    <li>Expand GRC training to all employees</li>
                                                </ul>
                                            }
                                            else if (currentLevel == 3)
                                            {
                                                <ul class="mb-0">
                                                    <li>Optimize metrics and KPIs</li>
                                                    <li>Implement statistical process control</li>
                                                    <li>Launch predictive compliance monitoring</li>
                                                    <li>Establish centers of excellence</li>
                                                </ul>
                                            }
                                            else
                                            {
                                                <ul class="mb-0">
                                                    <li>Scale innovation initiatives enterprise-wide</li>
                                                    <li>Publish thought leadership content</li>
                                                    <li>Establish industry partnerships</li>
                                                    <li>Launch GRC consulting practice (internal/external)</li>
                                                </ul>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Q4 -->
                        <div class="timeline-item">
                            <div class="row">
                                <div class="col-md-2">
                                    <div class="badge bg-warning text-dark py-2 px-3" style="font-size: 1rem;">Q4</div>
                                    <p class="small text-muted mt-2">Months 10-12</p>
                                </div>
                                <div class="col-md-10">
                                    <div class="card bg-light">
                                        <div class="card-body">
                                            <h6><i class="bi bi-trophy"></i> Consolidation Phase</h6>
                                            @if (currentLevel == 1)
                                            {
                                                <ul class="mb-0">
                                                    <li>Achieve Level 2 maturity certification</li>
                                                    <li>Document lessons learned and best practices</li>
                                                    <li>Plan Year 2 roadmap to Level 3</li>
                                                    <li>Celebrate successes and recognize contributors</li>
                                                </ul>
                                            }
                                            else if (currentLevel == 2)
                                            {
                                                <ul class="mb-0">
                                                    <li>Achieve Level 3 maturity certification</li>
                                                    <li>Conduct annual GRC effectiveness review</li>
                                                    <li>Plan Year 2 roadmap to Level 4</li>
                                                    <li>Share success stories organization-wide</li>
                                                </ul>
                                            }
                                            else if (currentLevel == 3)
                                            {
                                                <ul class="mb-0">
                                                    <li>Achieve Level 4 maturity certification</li>
                                                    <li>Publish GRC performance metrics</li>
                                                    <li>Plan Year 2 roadmap to Level 5</li>
                                                    <li>Begin industry benchmarking participation</li>
                                                </ul>
                                            }
                                            else
                                            {
                                                <ul class="mb-0">
                                                    <li>Achieve Level 5 maturity certification</li>
                                                    <li>Win industry awards and recognition</li>
                                                    <li>Plan continuous excellence roadmap</li>
                                                    <li>Establish GRC innovation fund</li>
                                                </ul>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dimension-Specific Improvement Plans -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-list-check"></i> Dimension-Specific Improvement Actions</h5>
                </div>
                <div class="card-body">
                    <div class="accordion" id="dimensionAccordion">
                        <!-- Process -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#processCollapse">
                                    <i class="bi bi-diagram-3 text-primary me-2"></i>
                                    Process Maturity (Current: @Model.ProcessMaturity.ToString("F1"))
                                </button>
                            </h2>
                            <div id="processCollapse" class="accordion-collapse collapse show" data-bs-parent="#dimensionAccordion">
                                <div class="accordion-body">
                                    <h6>Priority Actions:</h6>
                                    <ul>
                                        <li>Document and standardize risk assessment methodology</li>
                                        <li>Implement compliance obligation tracking workflow</li>
                                        <li>Deploy automated control testing procedures</li>
                                        <li>Establish process improvement review cycle</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- People -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#peopleCollapse">
                                    <i class="bi bi-people text-success me-2"></i>
                                    People Maturity (Current: @Model.PeopleMaturity.ToString("F1"))
                                </button>
                            </h2>
                            <div id="peopleCollapse" class="accordion-collapse collapse" data-bs-parent="#dimensionAccordion">
                                <div class="accordion-body">
                                    <h6>Priority Actions:</h6>
                                    <ul>
                                        <li>Launch GRC certification program for staff</li>
                                        <li>Conduct organization-wide GRC awareness training</li>
                                        <li>Establish GRC Community of Practice</li>
                                        <li>Implement succession planning for critical GRC roles</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Technology -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#technologyCollapse">
                                    <i class="bi bi-cpu text-info me-2"></i>
                                    Technology Maturity (Current: @Model.TechnologyMaturity.ToString("F1"))
                                </button>
                            </h2>
                            <div id="technologyCollapse" class="accordion-collapse collapse" data-bs-parent="#dimensionAccordion">
                                <div class="accordion-body">
                                    <h6>Priority Actions:</h6>
                                    <ul>
                                        <li>Deploy integrated GRC platform</li>
                                        <li>Implement real-time risk monitoring dashboards</li>
                                        <li>Automate compliance reporting and evidence collection</li>
                                        <li>Integrate GRC tools with enterprise systems (ERP, ITSM)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Governance -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#governanceCollapse">
                                    <i class="bi bi-shield-check text-warning me-2"></i>
                                    Governance Maturity (Current: @Model.GovernanceMaturity.ToString("F1"))
                                </button>
                            </h2>
                            <div id="governanceCollapse" class="accordion-collapse collapse" data-bs-parent="#dimensionAccordion">
                                <div class="accordion-body">
                                    <h6>Priority Actions:</h6>
                                    <ul>
                                        <li>Establish GRC steering committee with executive sponsors</li>
                                        <li>Define and communicate risk appetite and tolerance</li>
                                        <li>Implement GRC KPI dashboard for leadership</li>
                                        <li>Conduct quarterly GRC performance reviews</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Culture -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cultureCollapse">
                                    <i class="bi bi-heart text-danger me-2"></i>
                                    Culture Maturity (Current: @Model.CultureMaturity.ToString("F1"))
                                </button>
                            </h2>
                            <div id="cultureCollapse" class="accordion-collapse collapse" data-bs-parent="#dimensionAccordion">
                                <div class="accordion-body">
                                    <h6>Priority Actions:</h6>
                                    <ul>
                                        <li>Launch "tone from the top" GRC messaging campaign</li>
                                        <li>Recognize and reward GRC champions</li>
                                        <li>Embed GRC considerations in performance reviews</li>
                                        <li>Promote open discussion of risks and issues</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Metrics -->
    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm border-success">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0"><i class="bi bi-graph-up-arrow"></i> Success Metrics</h5>
                </div>
                <div class="card-body">
                    <p><strong>By the end of this 12-month roadmap, you should achieve:</strong></p>
                    <div class="row">
                        <div class="col-md-4">
                            <ul>
                                <li>Overall maturity advance to Level @targetLevel</li>
                                <li>All dimensions scoring â‰¥ @(targetLevel - 0.5m)</li>
                                <li>90%+ completion of roadmap milestones</li>
                            </ul>
                        </div>
                        <div class="col-md-4">
                            <ul>
                                <li>Measurable reduction in risk exposure</li>
                                <li>Improved compliance audit results</li>
                                <li>Enhanced stakeholder confidence</li>
                            </ul>
                        </div>
                        <div class="col-md-4">
                            <ul>
                                <li>Documented process improvements</li>
                                <li>Increased GRC team competencies</li>
                                <li>Industry recognition or certification</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@functions {
    private string GetLevelName(int level)
    {
        return level switch
        {
            5 => "Optimizing",
            4 => "Managed",
            3 => "Defined",
            2 => "Repeatable",
            _ => "Initial"
        };
    }
}
