@using Microsoft.AspNetCore.Mvc.Localization
@inject IHtmlLocalizer<SharedResource> L
@{
    ViewData["Title"] = "Benchmarking Dashboard";
    Layout = "_Layout";

    var benchmarks = ViewBag.Benchmarks as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var ksaBenchmarks = ViewBag.KsaBenchmarks as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col">
            <h2><i class="bi bi-bar-chart-line"></i> @L["BenchmarkingDashboard"]</h2>
            <p class="text-muted">@L["BenchmarkingDashboard_Description"]</p>
        </div>
        <div class="col text-end">
            <a asp-action="Industry" class="btn btn-outline-primary">
                <i class="bi bi-building"></i> @L["IndustryBenchmarks"]
            </a>
            <a asp-action="Peers" class="btn btn-outline-secondary">
                <i class="bi bi-people"></i> @L["PeerComparison"]
            </a>
            <a asp-action="Report" class="btn btn-primary">
                <i class="bi bi-file-earmark-bar-graph"></i> @L["GenerateReport"]
            </a>
        </div>
    </div>

    <!-- Overview Cards -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card bg-primary text-white shadow-sm">
                <div class="card-body">
                    <h6 class="opacity-75">@L["GlobalBenchmarks"]</h6>
                    <h2 class="mb-0">@benchmarks.Count()</h2>
                    <small>@L["DataPoints"]</small>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-success text-white shadow-sm">
                <div class="card-body">
                    <h6 class="opacity-75">@L["KSABenchmarks"]</h6>
                    <h2 class="mb-0">@ksaBenchmarks.Count()</h2>
                    <small>@L["LocalMarket"]</small>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-info text-white shadow-sm">
                <div class="card-body">
                    <h6 class="opacity-75">@L["YourPosition"]</h6>
                    <h2 class="mb-0">72%</h2>
                    <small>@L["Percentile"]</small>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-warning text-dark shadow-sm">
                <div class="card-body">
                    <h6>@L["ImprovementAreas"]</h6>
                    <h2 class="mb-0">5</h2>
                    <small>@L["Identified"]</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Benchmarking Comparison -->
    <div class="row mb-4">
        <div class="col-lg-8">
            <div class="card shadow-sm">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-graph-up"></i> @L["GRCMaturityComparison"]</h5>
                </div>
                <div class="card-body">
                    <canvas id="maturityComparisonChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-light">
                    <h6 class="mb-0"><i class="bi bi-trophy"></i> @L["Rankings"]</h6>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="small">@L["Governance"]</span>
                            <span class="badge bg-success">Top 25%</span>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-success" style="width: 85%"></div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="small">@L["RiskManagement"]</span>
                            <span class="badge bg-info">Top 40%</span>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-info" style="width: 72%"></div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="small">@L["Compliance"]</span>
                            <span class="badge bg-warning text-dark">Top 55%</span>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-warning" style="width: 68%"></div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="small">@L["Resilience"]</span>
                            <span class="badge bg-primary">Top 30%</span>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-primary" style="width: 78%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="small">@L["Excellence"]</span>
                            <span class="badge bg-danger">Top 65%</span>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-danger" style="width: 58%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Industry Sectors -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-building"></i> @L["IndustrySectors"]</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="card border-primary">
                                <div class="card-body">
                                    <h6><i class="bi bi-bank"></i> @L["FinancialServices"]</h6>
                                    <p class="small text-muted mb-2">@L["AverageMaturityScore"]</p>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="progress flex-grow-1 me-2" style="height: 20px;">
                                            <div class="progress-bar bg-primary" style="width: 82%">82%</div>
                                        </div>
                                        <a asp-action="Industry" asp-route-sectorCode="FIN" class="btn btn-sm btn-outline-primary">
                                            <i class="bi bi-arrow-right"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="card border-success">
                                <div class="card-body">
                                    <h6><i class="bi bi-hospital"></i> @L["Healthcare"]</h6>
                                    <p class="small text-muted mb-2">@L["AverageMaturityScore"]</p>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="progress flex-grow-1 me-2" style="height: 20px;">
                                            <div class="progress-bar bg-success" style="width: 78%">78%</div>
                                        </div>
                                        <a asp-action="Industry" asp-route-sectorCode="HLT" class="btn btn-sm btn-outline-success">
                                            <i class="bi bi-arrow-right"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="card border-info">
                                <div class="card-body">
                                    <h6><i class="bi bi-gear"></i> @L["Manufacturing"]</h6>
                                    <p class="small text-muted mb-2">@L["AverageMaturityScore"]</p>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="progress flex-grow-1 me-2" style="height: 20px;">
                                            <div class="progress-bar bg-info" style="width: 68%">68%</div>
                                        </div>
                                        <a asp-action="Industry" asp-route-sectorCode="MFG" class="btn btn-sm btn-outline-info">
                                            <i class="bi bi-arrow-right"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Key Insights -->
    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-lightbulb"></i> @L["KeyInsights"]</h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-success">
                        <i class="bi bi-check-circle"></i>
                        <strong>@L["Strength"]:</strong> @L["GovernanceFrameworkAboveIndustryAverage"]
                    </div>
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle"></i>
                        <strong>@L["OpportunityForImprovement"]:</strong> @L["ExcellenceProgramsBelowPeerAverage"]
                    </div>
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i>
                        <strong>@L["Recommendation"]:</strong> @L["FocusOnMaturityDimensionsWithLowestScores"]
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Maturity Comparison Chart
        const ctx = document.getElementById('maturityComparisonChart').getContext('2d');
        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['Governance', 'Risk Management', 'Compliance', 'Resilience', 'Excellence', 'Sustainability'],
                datasets: [{
                    label: 'Your Organization',
                    data: [85, 72, 68, 78, 58, 65],
                    borderColor: 'rgb(54, 162, 235)',
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderWidth: 2
                }, {
                    label: 'Industry Average',
                    data: [75, 70, 72, 68, 75, 70],
                    borderColor: 'rgb(255, 99, 132)',
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderWidth: 2,
                    borderDash: [5, 5]
                }, {
                    label: 'Top Performers',
                    data: [95, 92, 90, 88, 92, 90],
                    borderColor: 'rgb(75, 192, 192)',
                    backgroundColor: 'rgba(75, 192, 192, 0.1)',
                    borderWidth: 1,
                    borderDash: [10, 5]
                }]
            },
            options: {
                responsive: true,
                scales: {
                    r: {
                        min: 0,
                        max: 100,
                        ticks: {
                            stepSize: 20
                        }
                    }
                },
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });
    </script>
}
