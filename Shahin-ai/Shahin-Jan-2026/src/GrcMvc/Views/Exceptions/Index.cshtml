@{
    ViewData["Title"] = "Control Exceptions - Shahin FIX";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid mt-4">
    <div class="row mb-4">
        <div class="col-md-8">
            <h1 class="h3">
                <i class="fas fa-wrench text-info me-2"></i>Shahin FIX - Control Exceptions
            </h1>
            <p class="text-muted">Manage control exceptions, compensating controls, and remediation plans</p>
        </div>
        <div class="col-md-4 text-end">
            <a href="@Url.Action("Create")" class="btn btn-primary">
                <i class="fas fa-plus me-2"></i>Request Exception
            </a>
        </div>
    </div>

    <!-- Summary Cards -->
    <div class="row mb-4">
        <div class="col-md-2">
            <div class="card bg-warning text-dark">
                <div class="card-body text-center">
                    <h3 id="pendingCount">7</h3>
                    <small>Pending Approval</small>
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="card bg-success text-white">
                <div class="card-body text-center">
                    <h3 id="approvedCount">23</h3>
                    <small>Approved</small>
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="card bg-danger text-white">
                <div class="card-body text-center">
                    <h3 id="rejectedCount">4</h3>
                    <small>Rejected</small>
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="card bg-info text-white">
                <div class="card-body text-center">
                    <h3 id="expiringCount">5</h3>
                    <small>Expiring Soon</small>
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="card bg-secondary text-white">
                <div class="card-body text-center">
                    <h3 id="expiredCount">2</h3>
                    <small>Expired</small>
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="card bg-primary text-white">
                <div class="card-body text-center">
                    <h3 id="compensatingCount">15</h3>
                    <small>Compensating</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Pending Approvals -->
    <div class="card shadow-sm mb-4">
        <div class="card-header bg-warning text-dark">
            <h5 class="mb-0"><i class="fas fa-clock me-2"></i>Pending Approvals</h5>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>Exception ID</th>
                            <th>Control</th>
                            <th>Requested By</th>
                            <th>Risk Level</th>
                            <th>Duration</th>
                            <th>Submitted</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>EXC-2026-001</td>
                            <td>ECC-1-3-2 Password Policy</td>
                            <td>Ahmed Al-Rashid</td>
                            <td><span class="badge bg-warning text-dark">Medium</span></td>
                            <td>90 days</td>
                            <td>2 days ago</td>
                            <td>
                                <a href="@Url.Action("Review")?id=1" class="btn btn-sm btn-success me-1">
                                    <i class="fas fa-check"></i>
                                </a>
                                <a href="@Url.Action("Review")?id=1" class="btn btn-sm btn-danger">
                                    <i class="fas fa-times"></i>
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>EXC-2026-002</td>
                            <td>PDPL-4-2 Data Retention</td>
                            <td>Sara Mohammed</td>
                            <td><span class="badge bg-danger">High</span></td>
                            <td>60 days</td>
                            <td>1 day ago</td>
                            <td>
                                <a href="@Url.Action("Review")?id=2" class="btn btn-sm btn-success me-1">
                                    <i class="fas fa-check"></i>
                                </a>
                                <a href="@Url.Action("Review")?id=2" class="btn btn-sm btn-danger">
                                    <i class="fas fa-times"></i>
                                </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Active Exceptions -->
    <div class="card shadow-sm">
        <div class="card-header">
            <h5 class="mb-0"><i class="fas fa-list me-2"></i>Active Exceptions</h5>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover" id="exceptionsTable">
                    <thead class="table-light">
                        <tr>
                            <th>Exception ID</th>
                            <th>Control</th>
                            <th>Type</th>
                            <th>Risk</th>
                            <th>Status</th>
                            <th>Expiry</th>
                            <th>Compensating Control</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>EXC-2025-045</td>
                            <td>ECC-2-1-1</td>
                            <td>Technical Limitation</td>
                            <td><span class="badge bg-warning text-dark">Medium</span></td>
                            <td><span class="badge bg-success">Approved</span></td>
                            <td>Mar 15, 2026</td>
                            <td><i class="fas fa-check text-success"></i> Yes</td>
                            <td>
                                <a href="@Url.Action("Details")?id=45" class="btn btn-sm btn-outline-primary">
                                    <i class="fas fa-eye"></i>
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>EXC-2025-044</td>
                            <td>SAMA-3-2</td>
                            <td>Business Constraint</td>
                            <td><span class="badge bg-danger">High</span></td>
                            <td><span class="badge bg-success">Approved</span></td>
                            <td>Feb 28, 2026</td>
                            <td><i class="fas fa-check text-success"></i> Yes</td>
                            <td>
                                <a href="@Url.Action("Details")?id=44" class="btn btn-sm btn-outline-primary">
                                    <i class="fas fa-eye"></i>
                                </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

@section Scripts {
<script>
    $(document).ready(function() {
        // Initialize functionality
    });
</script>
}
